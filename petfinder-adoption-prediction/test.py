import numpy as np
import json

class NumpyEncoder(json.JSONEncoder):
    def default(self, obj):
        if isinstance(obj, (set, tuple)):
            return list(obj)
        elif isinstance(obj, np.integer):
            return int(obj)
        elif isinstance(obj, np.floating):
            return float(obj)
        elif isinstance(obj, np.ndarray):
            return obj.tolist()
        else:
            return json.JSONEncoder.default(self, obj)


data_fp = 'test'
sort_keys = True
indent = 4
data = {'Type':
            {'idx2str': ['<UNK>', '1', '2'],
             'str2idx': {'<UNK>': 0, '1': 1, '2': 2},
             'str2freq': {'<UNK>': 0, '1': 8132, '2': 6861},
             'vocab_size': 3,
             'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Age':
            {'preprocessing': {'computed_fill_value': dd.Scalar<series-..., dtype=float32>, 'missing_value_strategy': 'fill_with_mean', 'fill_value': 0, 'normalization': None}},
        'Breed1': {'idx2str': ['<UNK>', '307', '266', '265', '299', '264', '292', '285', '141', '205', '179', '218', '109', '254', '103', '243', '20', '213', '189', '283', '247', '195', '152', '128', '78', '306', '303', '69', '76', '119', '60', '251', '276', '241', '75', '26', '289', '39', '206', '207', '173', '252', '178', '182', '300', '147', '249', '169', '242', '282', '288', '49', '200', '72', '250', '295', '239', '50', '70', '117', '44', '15', '19', '83', '277', '305', '31', '231', '273', '284', '304', '102', '111', '17', '18', '202', '268', '272', '0', '185', '190', '240', '244', '253', '274', '280', '296', '297', '301', '42', '82', '100', '105', '129', '150', '187', '246', '294', '10', '114', '122', '155', '203', '204', '224', '227', '25', '262', '263', '267', '271', '279', '293', '32', '65', '97', '1', '108', '11', '132', '145', '148', '167', '188', '197', '199', '215', '232', '233', '234', '237', '24', '245', '248', '256', '260', '269', '270', '281', '5', '58', '71', '88', '98', '123', '125', '130', '139', '143', '146', '154', '16', '165', '176', '192', '201', '21', '212', '214', '217', '228', '23', '257', '286', '287', '290', '298', '3', '302', '56', '61', '64', '7', '81', '85', '93', '99'],
                   'str2idx': {'<UNK>': 0, '307': 1, '266': 2, '265': 3, '299': 4, '264': 5, '292': 6, '285': 7, '141': 8, '205': 9, '179': 10, '218': 11, '109': 12, '254': 13, '103': 14, '243': 15, '20': 16, '213': 17, '189': 18, '283': 19, '247': 20, '195': 21, '152': 22, '128': 23, '78': 24, '306': 25, '303': 26, '69': 27, '76': 28, '119': 29, '60': 30, '251': 31, '276': 32, '241': 33, '75': 34, '26': 35, '289': 36, '39': 37, '206': 38, '207': 39, '173': 40, '252': 41, '178': 42, '182': 43, '300': 44, '147': 45, '249': 46, '169': 47, '242': 48, '282': 49, '288': 50, '49': 51, '200': 52, '72': 53, '250': 54, '295': 55, '239': 56, '50': 57, '70': 58, '117': 59, '44': 60, '15': 61, '19': 62, '83': 63, '277': 64, '305': 65, '31': 66, '231': 67, '273': 68, '284': 69, '304': 70, '102': 71, '111': 72, '17': 73, '18': 74, '202': 75, '268': 76, '272': 77, '0': 78, '185': 79, '190': 80, '240': 81, '244': 82, '253': 83, '274': 84, '280': 85, '296': 86, '297': 87, '301': 88, '42': 89, '82': 90, '100': 91, '105': 92, '129': 93, '150': 94, '187': 95, '246': 96, '294': 97, '10': 98, '114': 99, '122': 100, '155': 101, '203': 102, '204': 103, '224': 104, '227': 105, '25': 106, '262': 107, '263': 108, '267': 109, '271': 110, '279': 111, '293': 112, '32': 113, '65': 114, '97': 115, '1': 116, '108': 117, '11': 118, '132': 119, '145': 120, '148': 121, '167': 122, '188': 123, '197': 124, '199': 125, '215': 126, '232': 127, '233': 128, '234': 129, '237': 130, '24': 131, '245': 132, '248': 133, '256': 134, '260': 135, '269': 136, '270': 137, '281': 138, '5': 139, '58': 140, '71': 141, '88': 142, '98': 143, '123': 144, '125': 145, '130': 146, '139': 147, '143': 148, '146': 149, '154': 150, '16': 151, '165': 152, '176': 153, '192': 154, '201': 155, '21': 156, '212': 157, '214': 158, '217': 159, '228': 160, '23': 161, '257': 162, '286': 163, '287': 164, '290': 165, '298': 166, '3': 167, '302': 168, '56': 169, '61': 170, '64': 171, '7': 172, '81': 173, '85': 174, '93': 175, '99': 176},
                   'str2freq': {'<UNK>': 0, '307': 5927, '266': 3634, '265': 1258, '299': 342, '264': 296, '292': 264, '285': 221, '141': 205, '205': 190, '179': 167, '218': 162, '109': 151, '254': 105, '103': 98, '243': 94, '20': 90, '213': 89, '189': 88, '283': 73, '247': 71, '195': 69, '152': 67, '128': 64, '78': 62, '306': 56, '303': 42, '69': 41, '76': 39, '119': 37, '60': 37, '251': 34, '276': 34, '241': 28, '75': 28, '26': 26, '289': 26, '39': 26, '206': 25, '207': 24, '173': 23, '252': 23, '178': 22, '182': 21, '300': 21, '147': 19, '249': 19, '169': 18, '242': 17, '282': 17, '288': 16, '49': 16, '200': 15, '72': 15, '250': 14, '295': 13, '239': 12, '50': 12, '70': 12, '117': 11, '44': 10, '15': 9, '19': 9, '83': 9, '277': 8, '305': 8, '31': 8, '231': 7, '273': 7, '284': 7, '304': 7, '102': 6, '111': 6, '17': 6, '18': 6, '202': 6, '268': 6, '272': 6, '0': 5, '185': 5, '190': 5, '240': 5, '244': 5, '253': 5, '274': 5, '280': 5, '296': 5, '297': 5, '301': 5, '42': 5, '82': 5, '100': 4, '105': 4, '129': 4, '150': 4, '187': 4, '246': 4, '294': 4, '10': 3, '114': 3, '122': 3, '155': 3, '203': 3, '204': 3, '224': 3, '227': 3, '25': 3, '262': 3, '263': 3, '267': 3, '271': 3, '279': 3, '293': 3, '32': 3, '65': 3, '97': 3, '1': 2, '108': 2, '11': 2, '132': 2, '145': 2, '148': 2, '167': 2, '188': 2, '197': 2, '199': 2, '215': 2, '232': 2, '233': 2, '234': 2, '237': 2, '24': 2, '245': 2, '248': 2, '256': 2, '260': 2, '269': 2, '270': 2, '281': 2, '5': 2, '58': 2, '71': 2, '88': 2, '98': 2, '123': 1, '125': 1, '130': 1, '139': 1, '143': 1, '146': 1, '154': 1, '16': 1, '165': 1, '176': 1, '192': 1, '201': 1, '21': 1, '212': 1, '214': 1, '217': 1, '228': 1, '23': 1, '257': 1, '286': 1, '287': 1, '290': 1, '298': 1, '3': 1, '302': 1, '56': 1, '61': 1, '64': 1, '7': 1, '81': 1, '85': 1, '93': 1, '99': 1},
                   'vocab_size': 177,
                   'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Breed2': {'idx2str': ['<UNK>', '0', '307', '266', '265', '299', '264', '292', '218', '141', '285', '103', '213', '254', '189', '109', '247', '179', '205', '243', '283', '303', '306', '276', '78', '128', '195', '152', '252', '26', '20', '75', '117', '119', '76', '251', '39', '241', '169', '187', '300', '147', '288', '295', '200', '60', '69', '72', '192', '249', '268', '305', '70', '173', '207', '246', '267', '129', '188', '206', '242', '248', '250', '271', '294', '44', '155', '18', '21', '24', '245', '256', '278', '282', '289', '296', '98', '10', '102', '14', '150', '16', '178', '19', '201', '202', '212', '227', '228', '270', '272', '274', '277', '284', '302', '49', '5', '50', '96', '1', '104', '111', '115', '122', '130', '146', '159', '167', '17', '176', '182', '190', '2', '203', '204', '210', '237', '239', '240', '25', '257', '260', '262', '263', '279', '290', '291', '293', '301', '304', '36', '4', '40', '58', '65', '83'],
                   'str2idx': {'<UNK>': 0, '0': 1, '307': 2, '266': 3, '265': 4, '299': 5, '264': 6, '292': 7, '218': 8, '141': 9, '285': 10, '103': 11, '213': 12, '254': 13, '189': 14, '109': 15, '247': 16, '179': 17, '205': 18, '243': 19, '283': 20, '303': 21, '306': 22, '276': 23, '78': 24, '128': 25, '195': 26, '152': 27, '252': 28, '26': 29, '20': 30, '75': 31, '117': 32, '119': 33, '76': 34, '251': 35, '39': 36, '241': 37, '169': 38, '187': 39, '300': 40, '147': 41, '288': 42, '295': 43, '200': 44, '60': 45, '69': 46, '72': 47, '192': 48, '249': 49, '268': 50, '305': 51, '70': 52, '173': 53, '207': 54, '246': 55, '267': 56, '129': 57, '188': 58, '206': 59, '242': 60, '248': 61, '250': 62, '271': 63, '294': 64, '44': 65, '155': 66, '18': 67, '21': 68, '24': 69, '245': 70, '256': 71, '278': 72, '282': 73, '289': 74, '296': 75, '98': 76, '10': 77, '102': 78, '14': 79, '150': 80, '16': 81, '178': 82, '19': 83, '201': 84, '202': 85, '212': 86, '227': 87, '228': 88, '270': 89, '272': 90, '274': 91, '277': 92, '284': 93, '302': 94, '49': 95, '5': 96, '50': 97, '96': 98, '1': 99, '104': 100, '111': 101, '115': 102, '122': 103, '130': 104, '146': 105, '159': 106, '167': 107, '17': 108, '176': 109, '182': 110, '190': 111, '2': 112, '203': 113, '204': 114, '210': 115, '237': 116, '239': 117, '240': 118, '25': 119, '257': 120, '260': 121, '262': 122, '263': 123, '279': 124, '290': 125, '291': 126, '293': 127, '301': 128, '304': 129, '36': 130, '4': 131, '40': 132, '58': 133, '65': 134, '83': 135},
                   'str2freq': {'<UNK>': 0, '0': 10762, '307': 1727, '266': 599, '265': 321, '299': 138, '264': 125, '292': 105, '218': 91, '141': 86, '285': 78, '103': 55, '213': 49, '254': 42, '189': 40, '109': 39, '247': 39, '179': 38, '205': 32, '243': 30, '283': 24, '303': 24, '306': 24, '276': 22, '78': 22, '128': 21, '195': 20, '152': 18, '252': 18, '26': 17, '20': 16, '75': 16, '117': 15, '119': 15, '76': 14, '251': 11, '39': 11, '241': 10, '169': 9, '187': 9, '300': 9, '147': 8, '288': 8, '295': 8, '200': 7, '60': 7, '69': 7, '72': 7, '192': 6, '249': 6, '268': 6, '305': 6, '70': 6, '173': 5, '207': 5, '246': 5, '267': 5, '129': 4, '188': 4, '206': 4, '242': 4, '248': 4, '250': 4, '271': 4, '294': 4, '44': 4, '155': 3, '18': 3, '21': 3, '24': 3, '245': 3, '256': 3, '278': 3, '282': 3, '289': 3, '296': 3, '98': 3, '10': 2, '102': 2, '14': 2, '150': 2, '16': 2, '178': 2, '19': 2, '201': 2, '202': 2, '212': 2, '227': 2, '228': 2, '270': 2, '272': 2, '274': 2, '277': 2, '284': 2, '302': 2, '49': 2, '5': 2, '50': 2, '96': 2, '1': 1, '104': 1, '111': 1, '115': 1, '122': 1, '130': 1, '146': 1, '159': 1, '167': 1, '17': 1, '176': 1, '182': 1, '190': 1, '2': 1, '203': 1, '204': 1, '210': 1, '237': 1, '239': 1, '240': 1, '25': 1, '257': 1, '260': 1, '262': 1, '263': 1, '279': 1, '290': 1, '291': 1, '293': 1, '301': 1, '304': 1, '36': 1, '4': 1, '40': 1, '58': 1, '65': 1, '83': 1},
                   'vocab_size': 136,
                   'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Gender': {'idx2str': ['<UNK>', '2', '1', '3'],
                   'str2idx': {'<UNK>': 0, '2': 1, '1': 2, '3': 3},
                   'str2freq': {'<UNK>': 0, '2': 7277, '1': 5536, '3': 2180},
                   'vocab_size': 4,
                   'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Color1': {'idx2str': ['<UNK>', '1', '2', '3', '5', '6', '7', '4'],
                   'str2idx': {'<UNK>': 0, '1': 1, '2': 2, '3': 3, '5': 4, '6': 5, '7': 6, '4': 7},
                   'str2freq': {'<UNK>': 0, '1': 7427, '2': 3750, '3': 947, '5': 884, '6': 684, '7': 667, '4': 634},
                   'vocab_size': 8,
                   'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Color2': {'idx2str': ['<UNK>', '0', '7', '2', '5', '6', '4', '3'],
                   'str2idx': {'<UNK>': 0, '0': 1, '7': 2, '2': 3, '5': 4, '6': 5, '4': 6, '3': 7},
                   'str2freq': {'<UNK>': 0, '0': 4471, '7': 3438, '2': 3313, '5': 1128, '6': 1063, '4': 870, '3': 710},
                   'vocab_size': 8,
                   'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Color3': {'idx2str': ['<UNK>', '0', '7', '5', '6', '4', '3'],
                   'str2idx': {'<UNK>': 0, '0': 1, '7': 2, '5': 3, '6': 4, '4': 5, '3': 6},
                   'str2freq': {'<UNK>': 0, '0': 10604, '7': 3221, '5': 417, '6': 378, '4': 198, '3': 175},
                   'vocab_size': 7,
                   'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'MaturitySize': {'idx2str': ['<UNK>', '2', '1', '3', '4'],
                         'str2idx': {'<UNK>': 0, '2': 1, '1': 2, '3': 3, '4': 4},
                         'str2freq': {'<UNK>': 0, '2': 10305, '1': 3395, '3': 1260, '4': 33},
                         'vocab_size': 5,
                         'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'FurLength': {'idx2str': ['<UNK>', '1', '2', '3'],
                      'str2idx': {'<UNK>': 0, '1': 1, '2': 2, '3': 3},
                      'str2freq': {'<UNK>': 0, '1': 8808, '2': 5361, '3': 824},
                      'vocab_size': 4,
                      'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Vaccinated': {'idx2str': ['<UNK>', '2', '1', '3'],
                       'str2idx': {'<UNK>': 0, '2': 1, '1': 2, '3': 3},
                       'str2freq': {'<UNK>': 0, '2': 7227, '1': 5898, '3': 1868},
                       'vocab_size': 4,
                       'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Dewormed': {'idx2str': ['<UNK>', '1', '2', '3'],
                     'str2idx': {'<UNK>': 0, '1': 1, '2': 2, '3': 3},
                     'str2freq': {'<UNK>': 0, '1': 8397, '2': 4815, '3': 1781},
                     'vocab_size': 4,
                     'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Sterilized': {'idx2str': ['<UNK>', '2', '1', '3'],
                       'str2idx': {'<UNK>': 0, '2': 1, '1': 2, '3': 3},
                       'str2freq': {'<UNK>': 0, '2': 10077, '1': 3101, '3': 1815},
                       'vocab_size': 4,
                       'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Health': {'idx2str': ['<UNK>', '1', '2', '3'],
                   'str2idx': {'<UNK>': 0, '1': 1, '2': 2, '3': 3},
                   'str2freq': {'<UNK>': 0, '1': 14478, '2': 481, '3': 34},
                   'vocab_size': 4,
                   'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'Quantity': {'preprocessing': {'computed_fill_value': 1, 'missing_value_strategy': 'fill_with_const', 'fill_value': 1, 'normalization': None}},
        'Fee': {'preprocessing': {'computed_fill_value': 0, 'missing_value_strategy': 'fill_with_const', 'fill_value': 0, 'normalization': None}},
        'Photo': {'preprocessing': {'missing_value_strategy': 'backfill', 'in_memory': True, 'resize_method': 'interpolate', 'scaling': 'pixel_normalization', 'num_processes': 1, 'height': 128, 'width': 128, 'num_channels': 3},
                  'reshape': (128, 128, 3)},
        'AdoptionSpeed': {'idx2str': ['<UNK>', '4', '2', '3', '1', '0'],
                          'str2idx': {'<UNK>': 0, '4': 1, '2': 2, '3': 3, '1': 4, '0': 5},
                          'str2freq': {'<UNK>': 0, '4': 4197, '2': 4037, '3': 3259, '1': 3090, '0': 410},
                          'vocab_size': 6,
                          'preprocessing': {'computed_fill_value': '<UNK>', 'most_common': 10000, 'lowercase': False, 'missing_value_strategy': 'fill_with_const', 'fill_value': '<UNK>'}},
        'data_processed_cache_dir': '/tmp/tmpu72iu681/c482fcf2-8dfd-11eb-bc3c-0c9d92207559',
        'dataset_training_fp': 'file:///tmp/tmpu72iu681/c482fcf2-8dfd-11eb-bc3c-0c9d92207559/training.parquet',
        'dataset_validation_fp': 'file:///tmp/tmpu72iu681/c482fcf2-8dfd-11eb-bc3c-0c9d92207559/validation.parquet',
        'dataset_test_fp': 'file:///tmp/tmpu72iu681/c482fcf2-8dfd-11eb-bc3c-0c9d92207559/test.parquet'}



with open(data_fp, 'w') as output_file:
    json.dump(data, output_file, cls=NumpyEncoder, sort_keys=sort_keys, indent=indent)